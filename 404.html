disabled = false;
                sendBtn.textContent = 'Send';
                
                // Add sources if available
                if (sources.length > 0) {
                    responseText += `<br><br><span class="text-xs text-gray-400 italic">Source: ${sources.join(', ')}</span>`;
                }
                
                displayMessage(responseText, false);

                if (responseText.includes("Sorry, I encountered an error")) {
                     errorMessage.textContent = "Could not connect to the AI. Check console for details.";
                     errorMessage.classList.remove('hidden');
                }
            }

            sendBtn.addEventListener('click', sendMessage);

            // Hide the error message on user input
            userInput.addEventListener('input', () => {
                errorMessage.classList.add('hidden');
            });
        });
    </script>
</body>
</html>


